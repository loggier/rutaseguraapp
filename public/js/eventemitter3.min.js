
!function(n,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):n.EventEmitter3=t()}(this,function(){"use strict";function n(n,t,e){this.fn=n,this.context=t,this.once=e||!1}function t(n,t,e,r,o){if("function"!=typeof n)throw new TypeError("The listener must be a function");var i=new n(n,r||o,e);"string"==typeof t?t in this._events?this._events[t].fn?this._events[t]=[this._events[t],i]:this._events[t].push(i):this._events[t]=[i]:this._events[t]=i}function e(n){var t,e,r,o,i=this._events;if(!i)return this;if(0===arguments.length){for(o in i)i.hasOwnProperty(o)&&(t=i[o])&&(t.fn?this.removeListener(o,t.fn,!1,!0):this.removeListener(o,t[t.length-1].fn,!1,!0));return delete this._events,this}if(t="string"==typeof n?i[n]:n,!t)return this;if(t.fn)this.removeListener(n,t.fn,!1,!0);else for(e=t.length-1;e>=0;e--)this.removeListener(n,t[e].fn,!1,!0);return r="",Object.keys(i).forEach(function(n){""!==r?r+=",":r+=n}),""===r&&delete this._events,this}function r(n,t,e,r){var o=n.split(this.delimiter),i=[];return o.forEach(function(n){for(var o,u=this._events,f=0,c=0,s="",a=n;~a.indexOf(this.wildcard);){if(s=a.slice(0,a.indexOf(this.wildcard)),u=u[s],!u)return;a=a.slice(a.indexOf(this.wildcard)+1)}if(s=n.slice(0,n.length-a.length),u=u[s],u){if(u.fn)return e&&this.removeListener(this.event,u.fn,!0),t.push(u.fn.apply(u.context,r)),!0;for(var v=Object.keys(u),l=v.length;f<l;f++)if(o=v[f],"_events"!==o){var h=this._getWildcardMatch(n.slice(c+v[f].length),u[v[f]],e,r,o,c+v[f].length);h&&i.push(h)}}}.bind(this)),i.length?i:null}var o=Object.prototype.hasOwnProperty,i="function"!=typeof Object.create,u="~",f=function(){};function c(n,t,e){this.fn=n,this.context=t,this.once=e||!1}function s(n,t,e,r,o){if("function"!=typeof n)throw new TypeError("The listener must be a function");var i=new c(n,r||o,e);return t.fn?t=[t,i]:t.push(i),t}function a(n,t){var e,r,o=[];for(e=0,r=t.length;e<r;e++)(t[e].fn!==n||t[e].once)&&o.push(t[e]);return o.length?1===o.length?o[0]:o:null}function v(){this._events=new f,this._eventsCount=0}i&&(Object.create=function(n){function t(){}return t.prototype=n,new t}),f.prototype=Object.create(null),v.prototype.eventNames=function(){var n,t,e=[];if(0===this._eventsCount)return e;t="string"==typeof(n=this._events)?Object.keys(n):n;for(var r=t.length-1;r>=0;r--)e.push(Object.getOwnPropertyNames(n[t[r]]));return e},v.prototype.listeners=function(n,t){var e=this._events[n];if(!e)return[];if(e.fn)return t?[e.fn]:[e];for(var r=0,o=e.length,i=new Array(o);r<o;r++)i[r]=e[r].fn;return i},v.prototype.emit=function(n,t,e,r,o,i){var u=this._events[n];if(!u)return!1;var f,c,s=u,a=arguments.length;if(u.fn){u.once&&this.removeListener(n,u.fn,void 0,!0),f=u.fn;for(var v=1,l=new Array(a-v);v<a;v++)l[v-1]=arguments[v];f.apply(u.context,l)}else{var h=u.length;for(c=0;c<h;c++)u[c].once&&this.removeListener(n,u[c].fn,void 0,!0),f=u[c].fn;for(var v=1,l=new Array(a-v);v<a;v++)l[v-1]=arguments[v];f.apply(u[c].context,l)}return!0},v.prototype.on=function(n,t,e){return s(n,this._events[n]||(this._events[n]=[],this._eventsCount++),!1,t,this),this},v.prototype.once=function(n,t,e){return s(n,this._events[n]||(this._events[n]=[],this._eventsCount++),!0,t,this),this},v.prototype.removeListener=function(n,t,e,r,o){var i=this._events[n];if(!i)return this;if(!t)return this;var u=a(t,i,r);if(i!==u){if(u)this._events[n]=u;else if(delete this._events[n],this._eventsCount--,0===this._eventsCount)return this._events=new f,this}return this},v.prototype.removeAllListeners=function(n){return n?this._events[n]&&(delete this._events[n],this._eventsCount--,0===this._eventsCount&&(this._events=new f)):(this._events=new f,this._eventsCount=0),this},v.prototype.off=v.prototype.removeListener,v.prototype.addListener=v.prototype.on,v.prototype.setMaxListeners=function(){return this};try{Object.defineProperty(v.prototype,"delimiter",{value:".",enumerable:!0}),Object.defineProperty(v.prototype,"wildcard",{value:"*",enumerable:!0})}catch(n){}return v.EventEmitter2=v,v.EventEmitter=v,v.prototype.listeners=function(n){var t,e=this.event,r=this._events,o=n?e.split(this.delimiter):[];if(o.length)return this._getWildcardMatch(e,r,n,!1);if(!r)return[];if(t=r[e],!t)return[];if("function"==typeof t.fn)return[t.fn];for(var i=0,u=t.length,f=new Array(u);i<u;i++)f[i]=t[i].fn;return f},v.prototype.listeners.fn=function(n){var t,e,r=this.listeners(n),o=new Array,i=function(n){o.push(n)};for(t=0,e=r.length;t<e;t++)"function"==typeof r[t]&&i(r[t]);return o},v.prototype.on=v.prototype.addListener=function(n,e){return"function"!=typeof e?this:(t.call(this,e,n,!1),this)},v.prototype.once=function(n,e){return"function"!=typeof e?this:(t.call(this,e,n,!0),this)},v.prototype.removeListener=function(n,t){return"function"!=typeof t?this:(e.call(this,n,t),this)},v.prototype.removeAllListeners=function(n){return e.call(this,n),this},v.prototype.many=function(n,e,r){var o=this;if("function"!=typeof r)throw new Error("fn must be a function");n.forEach(function(n){for(var t=0;t<e;t++)o.once(n,r)})},v.prototype.emit=function(){this.event=arguments[0];var n=arguments.length,t=this.event.split(this.delimiter),e=Array.prototype.slice.call(arguments,1),o=!0,i=this._events;if(!i)return!1;if("newListener"===this.event)return this._events.newListener?!!Array.isArray(i.newListener)&&(i.newListener.forEach(function(n){n.fn.apply(n.context,e)}),!0):!1;if(2===t.length&&"*"===t[0]&&"*"===t[1]){var u,f,c,s;for(u in i)if(o.call(i,u)){f=i[u];if(f)for(c=0,s=f.length;c<s;c++)f[c].fn.apply(f[c].context,e)}return!0}return r.call(this,this.event,!0,!1,e)},v.prototype.emitAsync=function(){this.event=arguments[0];var n=this.event.split(this.delimiter),t=Array.prototype.slice.call(arguments,1);if(!this._events)return!1;var e;return 2===n.length&&"*"===n[0]&&"*"===n[1]&&(e=r.call(this,this.event,!0,!1,t)),e||(e=r.call(this,this.event,!0,!0,t)),e||!1},v.prototype.off=v.prototype.removeListener,v});

    